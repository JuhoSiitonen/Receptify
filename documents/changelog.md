# Changelog

## December 2023
- 30.12 : Initialization of frontend, backend and documentation.
- 31.12 : Basic setup of backend, added Express. Also made a logger for request info and a basic recipy endpoint controller. Redux chosen as state management, Axios handles frontend requests.

## January 2024
- 1.1 : Creating component structure and Redux basic setup.
- 2.1 : Page for posting recipies added along with Redux, Axios and backend support.
- 3.1 : Added possibility to add multiple ingredients and categories to one recipy. Also added basic login form and page. 
- 5.1 : 
    - Added Nodemon to backend dev depencies
    - Added Sequelize and an initial schema file with initial models for said schema. 
    - Also added a connection info string when starting backend. During dev stage PostgreSQL is run by Docker container, and backend has a .env file with the connection string for it. 
    - Created models for using Sequelize with initial schema.
    - Removed mock data for recipies and replaced with actual working post request with current Sequelize models (only in backend).
- 6.1 : 
    - Added post for a new user in backend, frontend to be implemented.
    - Sequelize models initialized with models/index.js file and synced at startup. 
    - GET works in frontend from database.
    - Added page for logging in and signing up, also preliminary Axios services and reducers in userReducer.js
    - Logging in through separate loginService and signing up through userService.
    - Logging in and signing up works in frontend! User information in Redux state. Signing up also logs user in and navigates to mainpage.
    - Posting new recipies works through add recipies page, now in use with hardcoded user id, actual id will be implemented with authenticated login.
- 7.1 :
    - Added endpoints for testing and healthchecks to backend.
    - Fixed posting a new recipy, now the new recipy is returned from backend with the ingredients and categories which are in a connection table.
    - Frontend navigates to recipy view after posting a new recipy and new recipy is immediately shown.
    - Added component and page for users own recipies.
- 8.1 :
    - Added LoadingSpinner as a component to view as app is loading.
    - Preliminary setup of userpage. Shows users own recipies. 
    - Logout functionality added, and user info stored in localstorage for now. Logout clears localstorage and navigates to login page. 
    - Notification component added to show below navbar.
    - Filter component added to recipy view. 
    - Endpoint for getting and posting comments.
    - Notification and filter reducers added with preliminary content. 
- 9.1 :
    - Added endpoint for requesting average ratings for a recipy. 
    - Components for commenting a recipy and rating a recipy.
    - Component for making elements togglable by buttons.
    - Services for adding comments and ratings.
    - Get and Post works for ratings, get request for ratings sends the rating average. Had to re import sequelize in the recipyRouter module.
    - Get and Post for ratings and comments implemented for frontend with separate reducers.
- 10.1 :
    - New components added for a single recipy view showing all comments and the rating average.
- 11.1 :
    - Refactoring to make component structure more cohesive, offloading stuff from SingleRecipy to elsewhere.
    - Fixing the view for a single recipies comments and rating average, added try catch structure to reducers for debugging.
    - First version of filter component with more than placeholders. The recipies can be filtered according to: username, ingredients, title and categories.
    - Filtering only in frontend from the Redux state, later an endpoint for searching specific ingredients will be added.
    - Filter function works for all specified filter options
    - Filter is reversed to default if the filter component is not visible
- 12.1 :
    - Added component for finding recipies based on available ingredients
    - Endpoint ingredients added in backend
    - Ednpoints for deleting and updating recipies added in backend
- 15.1 : 
    - Notifications functionality added with successfull action and error notifications, this works via notificationReducer.
    - Notifications are up for signup, logging in, comments, ratings and posting new recipies.
    - User input validation for signup
    - Recipy router refactoring to separate ratings and comments as separate routers
    - Comment and rating update and delete endpoints added
    - Comment, rating and recipy update and delete axios services added.
    - User deletion service added. 
- 16.1 :
    - Preliminary form for updating a users own recipy
    - Only logged in users can now see Comment and Rate buttons
    - Recipy owner can't comment or rate their own recipy
    - Recipy owner can enter update form from ChosenRecipy component
    - Recipy owner can delete their own recipies from ChosenRecipy component
    - Update form shows old recipy info, not yet fully functional
- 19.1 :
    - Update sends requests correctly to backend, but backend endpoint needs fixing.
- 22.1 :
    - Finishing update functionality for recipies
    - Routing directly to a single recipy view via url now possible
    - Rating average added as a recipy model column in database
    - Average rating shown in recipies view and is updated on screen when user posts a rating
    - Recipyreducer updated with a "updaterating" reducer function 
- 23.1 :
    - User can delete own comments from recipies.
    - RatingAverage component deleted and single recipy view refactored.
    - Removed unnecessary parameters from recipy update requests
    - Seeing all comments of single recipy togglable
- 29.1 : 
    - Migrations added to previous database tables.
    - Added Jest and Supertest to dev dependencies and started testing backend. 
    - Tests for controllers for recipies, users, comments and ratings added. 
    - Dockerfiles and dev.Dockerfiles added to front and backend.
- 30.1 :
    - More backend testing and test refactoring to use dedicated testing/reset endpoint to setup database tables, also a util module test_helpers for test variables.
    - Redis basic setup via docker container. 
    - First Redis implementation in session handling.
    - Redis folder with index.js added with redisClient initializing and connecting.
    - Removed earlier session handling via local storage.
    - Redis bug fixing and hunting.
- 31.1 : 
    - Redis session cookie settings debugging. 
    - CORS settings updated to allow only frontend connections 
    - Axios updated to use credentials
    - Redis cookie settings updated. Cookie is passed with requests and responses but not stored in Chrome. Works in Firefox as intended. 
    - Frontend testing started with Jest and Cypress for E2E.

## February 2024
- 1.2 :
    - MSW added as a dev dependency to make frontend integration tests
    - Created util/test-utils.jsx to wrap custom render function for testing component with Redux store provider and React router.
    - Undici and isomorphic-fetch added as dev dependency to get MSW working with Jest
    - Login component testing.
- 2.2 :
    - E2E testing with Cypress in frontend folder. 
    - Cypress testing for signing up, backend startup with node env as test.
    - Debugging Redis sessions, now working with Chrome also with CORS settings accepting only frontend requests
- 3.2 : 
    - Redis sessions work now, fault was in the Axios service call and the backend session endpoint (more accurately the api/users/:id existed also so all the calls to api/users/session went to :id ...)
    - Fixed race condition with App.js useEffect call where two Redis sessions were created when opening app. This required some re structuring of the call to get the recipies. 
    - New component ViewUser for viewing a single users recipies, also added a service method, reducer method and endpoint for api/users/:id/view.
- 5.2 :
    - Uploadcare added to handle validation and storage of pictures related to recipies and user profile pictures. Preliminary setup done in frontend. 
- 9.2 : 
    - Debugging Uploadcare to get sent pictures uuid. 
- 11.2 :
    - Switched to using Uploadcare React widget instead of the previous unstable release.
    - Uploadcare picture preview in AddRecipyView
- 12.2 : 
    - Showcasing pictures in recipiesview added.
    - Database table for friendships added.
    - New AddFriendButton which is rendered in ViewUser page for adding friends. 
    - Endpoints for adding and deleting friends with a userinfo get endpoint.
    - Frontend Axios services for deleting and adding friends.
    - Frontend reducers added to modify user reducer state where current users friends are stored.
- 13.2 : 
    - Changing the "friends" table to a more suitable name "subscriptions", changes in backend and frontend.
    - Subscribing added in userReducer to give user meaningful error messages.
    - Togglable component made more functional with props for cancel button text and cancel button location. 
    - Added database table for favorites where a users favorite recipies are listed. 
    - Frontend services and reducers added for favorites.
    - Small refactoring within RecipiesView components to use subscription button and favorite buttons. 
- 14.2 : 
    - Small changes in Favorites and Subscriptions models to be able to query them inside a user related query.
    - Favorites and subscriptions added to Redux state.
- 16.2 : 
    - Redis state is updated everytime a new favorite or subscription is added, from here it is sent to Redux state via session endpoint which is called on refresh. 
    
